---
title: DNS とソフトウェアアーキテクチャ
description: DNS について学び、それをソフトウェアアーキテクチャに絡めて理解する記事。
summary: DNS について学びます。特にソフトウェアアーキテクチャに絡めて学びます。
slug: dns-basics
tags:
  - ソフトウェア設計
  - Tech
date: "2026-02-11"
---

DNS の仕組みや構造を、ソフトウェアアーキテクチャに絡めつつ学びます。
これも Roadmap の一部です。

https://roadmap.sh/system-design

## DNS の意義
DNS はドメイン名を IP アドレスに解決してくれる仕組みです。  
`153.204.103.xxx` のような IP アドレスを覚えるのは困難ですが、`blog.takamin55.dev` であれば覚えられるので、ありがたいですよね。

しかしながら、DNS はどうして生まれたのか。

その課題意識を紐解きながら DNS を理解していきます。

### DNS がない世界の課題
DNS がない世界の課題をいくつか見てみましょう。

最近なんだかブログを書いてインターネット上で発信したくなってきたので、`takamin55's ブログ` というタイトルでブログを書くことにしました。

インターネットを通してアクセスしてもらうには IP アドレスが必要ですから、なんとか `121.183.32.999` を手に入れて宣伝します。「`takamin55's ブログ`を作ったので、`121.183.32.999` でアクセスしてね」と。

これからは友人やその他興味がある人はブラウザに `121.183.32.999` を入れることでブログに辿り着けますが、覚えにくいですね…。

> 課題1: IP アドレスでは覚えにくい

もし公開するサーバーを変更したら IP アドレスが変わるので、「ブログのサーバーを変えたので今度からは `121.183.32.888` でアクセスしてください！」とみんなに連絡する必要がありそうです。

> 課題2: IP アドレスの変更を吸収できない

アクセスを捌くためにサーバーを複数台立てた場合は、IP アドレスを複数個持ちますが、ユーザーは全部の IP を覚える必要があります。前段にロードバランサーを構えてその IP を教えておけば問題は解決できますが、最初からロードバランサーを構えていない場合は先ほどと同じく IP アドレス変更時の対応が必要です。

> 課題3: LB や CDN などの柔軟な配信がやりにくい

多分まだまだありますが、こんな課題がありそうですね。

### DNS があれば…
先ほどの課題を解決するために、名前と IP アドレスを解決する `DNS` が生まれました。DNS がある世界では

1. ドメイン名でアクセスする
2. ドメイン名を IP アドレスに直す
3. IP アドレスでサーバーにアクセスする

という手順を取ります。

2 の処理でさっきの課題を全て解決できます。例えばサーバーを引っ越して IP アドレスが変わってしまっても、ユーザーがやる「`blog.takamin55.dev` にアクセスする」は変わらないので、引越しが簡単です（`121.183.32.999(旧)` から `121.183.32.888(新)` を教えるように裏側を変えるだけ）。

負荷分散やユーザーに近いサーバーの IP を教えることももちろんできますよね。

## DNS の仕組み
というわけで重要な DNS ですが、どうやって実現しているのでしょうか。

ざっくり編と正式名称編で分けて説明します。

### DNS の仕組み（ざっくり編）
まず「ドメイン名を聞かれたら IP アドレスを返すサーバー」が絶対必要ですよね。というわけで用意しました（ドン）。

しかし大変です。あらゆるドメインに対応できる必要があるので、情報量や保守の面でもカオスな状況になってきました。

```
blog.takamin55.dev -> 123.456.789.777
piyopiyo-hiyoko.com -> 14.14.145.888
www.travel-sekai.co.jp -> 200.200.200.999
...
```

今後サーバーが増えるたびにドメイン名と IP アドレスのペアを記録していく必要があります。流石に大変です…。

それなら「最後の `.jp` などに注目してここでグループ化し、そのグループについて集中的に管理するサーバーを立てて、そのサーバーの IP アドレスを教えてあげるサーバーを作れば、うまく管理をあけ渡せるのでは！？」と考えました。つまり

```
■ グループを管理するサーバーの IP アドレスを返すサーバー
.dev -> 3.3.3.999
.jp -> 1.1.1.777
.com -> 2.2.2.888
```

```
■ .dev を担当する サーバー
takamin55.dev -> 4.4.4.999
...
```

```
■ takamin55.dev を担当する サーバー
blog.takamin55.dev -> 123.456.789.777
...

```

のようにするわけです。この場合リクエストは以下の手順になります。

1. ドメイン名(`blog.takamin55.dev`)でアクセスする
2. そのグループ(`.dev`)を管理するサーバーの IP アドレスがわかる
3. 教えてもらったサーバーにアクセスすると、今度は次のグループ(`takamin55.dev`)を管理するサーバーの IP アドレスがわかる
4. 繰り返す…
5. 最終的にアクセスしたかったサーバーに IP アドレスがわかる

これでも「ユーザーは `blog.takamin55.dev` にアクセスするだけでよい」のは変わりません。  
また、グループごとにドメインと IP アドレスの管理を任せることができたので、大量情報問題も解決してスッキリですし、それでもやっぱり管理が大変ならさらにグループを分ける（例えば `.jp` をさらに `co.jp`, `.ac.jp`, `.ne.jp` など）ことで解決できます。素晴らしい。

ざっくりこれが DNS の仕組みです。

### DNS の仕組み（正式名称編）
`.jp` などのグループに分けるという表現をしましたが、ドメインの中の最上位に位置するグループなので `TLD (トップレベルドメイン)` と言います。

そしてトップレベルドメインの居場所を返す最初のサーバーを、最初なので `ルートサーバー` と呼びます。

`blog.takamin55.dev` にアクセスするとき、

1. ルートサーバー
2. `.dev` の TLD サーバー
3. `takamin55.dev` の権威サーバー

という順番に解決されます。最後の権威サーバーが `blog.takamin55.dev` を IP アドレスに解決します。

### その他の重要な仕組み
リゾルバ、キャッシュ、レコードに触れないといけない点だけ書き残しておきます。

## DNS のソフトウェアアーキテクチャ的意義
DNS が教えてくれるのは「抽象レイヤーの追加」や「階層化を使った委譲」「キャッシュ」などの戦略です。

細かく書くと大変なのでざっくり書きますが、DNS によって IP 直接アクセスの世界からは`パフォーマンス`が落ちました。代わりに権威サーバーへの委譲の仕組みを通じて世界中にサーバーを分散しており、キャッシュの仕組みもあるので、アクセスが増加してもパフォーマンスを落とさない高い`スケーラビリティ`を手に入れています。

世界中にサーバーがあり、とある権威サーバーが落ちても他のサーバーに連絡を取ったり、またはキャッシュした結果を返せば良いため、`分断耐性`や`可用性`が優秀です。代わりに、問い合わせる権威サーバー次第では古い IP が解決されたり、DNS リゾルバが古い情報をキャッシュしていたりと、`一貫性`はある程度低い状態を許容しています。

だめだ。本当はもっとしっかり&綺麗にまとめたいのだけれど、ブログなのでそこまで元気が出ない。

## 終わりに
DNS を改めて勉強できました。
